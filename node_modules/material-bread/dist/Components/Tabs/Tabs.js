var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports.default=exports.TabsContext=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf3=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));var _react=_interopRequireWildcard(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _reactNative=require("react-native");var _Tab=_interopRequireDefault(require("./Tab/Tab"));var _Underline=_interopRequireDefault(require("./Underline/Underline"));var _withTheme=_interopRequireDefault(require("../../Theme/withTheme"));var _Tabs=_interopRequireDefault(require("./Tabs.styles"));var _jsxFileName="/Users/cody/projects/material-bread/src/Components/Tabs/Tabs.js";var TabsContext=_react.default.createContext();exports.TabsContext=TabsContext;var Tabs=function(_Component){(0,_inherits2.default)(Tabs,_Component);function Tabs(){var _getPrototypeOf2;var _this;(0,_classCallCheck2.default)(this,Tabs);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=(0,_possibleConstructorReturn2.default)(this,(_getPrototypeOf2=(0,_getPrototypeOf3.default)(Tabs)).call.apply(_getPrototypeOf2,[this].concat(args)));(0,_defineProperty2.default)((0,_assertThisInitialized2.default)(_this),"state",{tabWidth:0,barWidth:0,indicatorPosition:new _reactNative.Animated.Value(0)});return _this;}(0,_createClass2.default)(Tabs,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var _this2=this;var actionItems=this.props.actionItems;if(actionItems.length!==prevProps.actionItems.length&&this.container){this.container.measure(function(_,b,width){_this2.getTabWidth(width);});}this.selectTab();}},{key:"shouldComponentUpdate",value:function shouldComponentUpdate(nextProps){var actionItems=this.props.actionItems;return actionItems.length!==nextProps.actionItems.length||nextProps.selectedIndex<nextProps.actionItems.length&&nextProps.selectedIndex>=0;}},{key:"getAnimateValues",value:function getAnimateValues(){var _this$props=this.props,selectedIndex=_this$props.selectedIndex,scrollEnabled=_this$props.scrollEnabled,actionItems=_this$props.actionItems;var _this$state=this.state,tabWidth=_this$state.tabWidth,barWidth=_this$state.barWidth;var index=selectedIndex;var scrollValue=!scrollEnabled?tabWidth:barWidth*0.4;if(scrollValue<90)scrollValue=90;if(!scrollEnabled&&scrollValue>90){return{indicatorPosition:index===0?0:index*scrollValue,scrollPosition:0};}switch(index){case 0:return{indicatorPosition:0,scrollPosition:0};case 1:return{indicatorPosition:barWidth*0.5-scrollValue/4,scrollPosition:scrollValue*0.25};case actionItems.length-1:return{indicatorPosition:scrollValue*(index-1)+(barWidth*0.5-scrollValue/4),scrollPosition:scrollValue*(index-2)+scrollValue*0.5};default:return{indicatorPosition:scrollValue*(index-1)+(barWidth*0.5-scrollValue/4),scrollPosition:scrollValue*0.25+scrollValue*(index-1)};}}},{key:"selectTab",value:function selectTab(){var _this$getAnimateValue=this.getAnimateValues(),indicatorPosition=_this$getAnimateValue.indicatorPosition,scrollPosition=_this$getAnimateValue.scrollPosition;_reactNative.Animated.spring(this.state.indicatorPosition,{toValue:_reactNative.I18nManager.isRTL?-indicatorPosition:indicatorPosition,tension:300,friction:20,useNativeDriver:true}).start();if(this.scrollView){this.scrollView.scrollTo({x:scrollPosition});}}},{key:"getTabWidth",value:function getTabWidth(width){var _this$props2=this.props,scrollEnabled=_this$props2.scrollEnabled,actionItems=_this$props2.actionItems;if(!scrollEnabled){var tabWidth=width/actionItems.length;this.setState({tabWidth:tabWidth});}this.setState({barWidth:width});}},{key:"getColor",value:function getColor(){var _this$props3=this.props,backgroundColor=_this$props3.backgroundColor,theme=_this$props3.theme;var implementedColor=backgroundColor?backgroundColor:theme.primary.main;return implementedColor;}},{key:"_renderTabs",value:function _renderTabs(){var _this$props4=this.props,scrollEnabled=_this$props4.scrollEnabled,actionItems=_this$props4.actionItems,handleChange=_this$props4.handleChange,selectedIndex=_this$props4.selectedIndex;var _this$state2=this.state,tabWidth=_this$state2.tabWidth,barWidth=_this$state2.barWidth;var tabWidthImplemented=!scrollEnabled?tabWidth:barWidth*0.4;if(tabWidthImplemented<90)tabWidthImplemented=90;return actionItems.map(function(item,index){if(!item.props){return _react.default.createElement(_Tab.default,{key:index,label:item.label,icon:item.icon,onPress:function onPress(){handleChange(index);if(item.onPress)item.onPress();},active:index===selectedIndex,tabWidth:tabWidthImplemented,__source:{fileName:_jsxFileName,lineNumber:157}});}else{return _react.default.cloneElement(item,{key:index,active:index===selectedIndex,tabWidth:tabWidthImplemented,onPress:function onPress(){handleChange(index);if(item.props.onPress)item.onPress();}});}});}},{key:"_renderContent",value:function _renderContent(){var _this$props5=this.props,scrollEnabled=_this$props5.scrollEnabled,underlineColor=_this$props5.underlineColor,underlineHeight=_this$props5.underlineHeight;var _this$state3=this.state,tabWidth=_this$state3.tabWidth,indicatorPosition=_this$state3.indicatorPosition,barWidth=_this$state3.barWidth;var tabWidthImplemented=!scrollEnabled?tabWidth:barWidth*0.4;if(tabWidthImplemented<90)tabWidthImplemented=90;return _react.default.createElement(_react.Fragment,{__source:{fileName:_jsxFileName,lineNumber:191}},_react.default.createElement(_reactNative.View,{style:_Tabs.default.tabsWrapper,__source:{fileName:_jsxFileName,lineNumber:192}},this._renderTabs()),_react.default.createElement(_Underline.default,{underlineHeight:underlineHeight,color:underlineColor,value:indicatorPosition,tabWidth:tabWidthImplemented,__source:{fileName:_jsxFileName,lineNumber:194}}));}},{key:"_renderScrollView",value:function _renderScrollView(){var _this3=this;var scrollEnabled=this.props.scrollEnabled;var _this$state4=this.state,tabWidth=_this$state4.tabWidth,barWidth=_this$state4.barWidth;var tabWidthImplemented=!scrollEnabled?tabWidth:barWidth*0.4;if(scrollEnabled||tabWidthImplemented<90){return _react.default.createElement(_reactNative.ScrollView,{horizontal:true,ref:function ref(_ref){_this3.scrollView=_ref;},showsHorizontalScrollIndicator:false,keyboardShouldPersistTaps:'never',scrollEnabled:scrollEnabled||tabWidthImplemented<90,__source:{fileName:_jsxFileName,lineNumber:212}},this._renderContent());}else{return this._renderContent();}}},{key:"render",value:function render(){var _this4=this;var _this$props6=this.props,style=_this$props6.style,testID=_this$props6.testID;return _react.default.createElement(TabsContext.Provider,{__source:{fileName:_jsxFileName,lineNumber:232}},_react.default.createElement(_reactNative.View,{style:[_Tabs.default.container,{backgroundColor:this.getColor()},style],testID:testID,ref:function ref(_ref2){_this4.container=_ref2;},onLayout:function onLayout(event){return _this4.getTabWidth(event.nativeEvent.layout.width);},__source:{fileName:_jsxFileName,lineNumber:233}},this._renderScrollView()));}}]);return Tabs;}(_react.Component);(0,_defineProperty2.default)(Tabs,"propTypes",{actionItems:_propTypes.default.arrayOf(_propTypes.default.oneOfType([_propTypes.default.object,_propTypes.default.element])),selectedIndex:_propTypes.default.number,backgroundColor:_propTypes.default.string,underlineColor:_propTypes.default.string,underlineHeight:_propTypes.default.number,scrollEnabled:_propTypes.default.bool,handleChange:_propTypes.default.func,style:_propTypes.default.oneOfType([_propTypes.default.object,_propTypes.default.array]),theme:_propTypes.default.object,testID:_propTypes.default.string});(0,_defineProperty2.default)(Tabs,"defaultProps",{selectedIndex:0,underlineColor:'#fff',scrollEnabled:false});var _default=(0,_withTheme.default)(Tabs);exports.default=_default;